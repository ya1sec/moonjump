<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Moonjump</title>
  <!-- Meta tags -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Add Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- CSS -->
  <link rel="stylesheet" type="text/css" media="screen" href="/static/assets/css/hack.css" />
  <!-- Add custom Tailwind config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'neon-red': '#ff0033',
          },
        },
      },
    }
  </script>
</head>

<body>
  <!-- Top Toolbar -->
  <div id="top-toolbar">
    <div class="relative">
      <label for="Search" class="sr-only"> Search </label>

      <input type="text" id="Search" placeholder="Search for..."
        class="w-full rounded-md border-gray-200 py-2.5 pe-10 shadow-sm sm:text-sm" />

      <span class="absolute inset-y-0 end-0 grid w-10 place-content-center">
        <button type="button" class="text-gray-600 hover:text-gray-700">
          <span class="sr-only">Search</span>

          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
            stroke="currentColor" class="size-4">
            <path stroke-linecap="round" stroke-linejoin="round"
              d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
          </svg>
        </button>
      </span>
    </div>
  </div>

  <!-- Main Content -->
  <div id="main-content">
    <img id="logo" src="/static/assets/img/sun.svg" alt="Moonjump Logo">
  </div>

  <!-- Jump Result (Iframe) -->
  <div id="jump-result" style="display: none;">
    <button class="close-button">&times;</button>
    <div class="iframe-container">
      <iframe id="jump-iframe" sandbox="allow-scripts allow-same-origin allow-popups allow-forms"></iframe>
    </div>
  </div>

  <!-- Info Section -->
  <div id="info-section" style="display: none;">
    <div id="info-content">
      <h2>About Moonjump</h2>
      <p>Moonjump is a server that redirects you to a random page harvested from the arcane depths of the web.</p>
      <!-- Add more informational content as needed -->
      <button id="close-info-button">Close</button>
    </div>
  </div>

  <!-- Bottom Toolbar -->
  <div id="bottom-toolbar" class="flex justify-center items-center">
    <span class="inline-flex -space-x-px overflow-hidden rounded-md border bg-white shadow-sm">
      <button id="share-button"
        class="inline-block px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:relative">
        Share
      </button>

      <button id="jump-button"
        class="inline-block px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:relative">
        <svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 text-neutral-600">
          <path
            d="M8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645L12.8536 7.14645C13.0488 7.34171 13.0488 7.65829 12.8536 7.85355L8.85355 11.8536C8.65829 12.0488 8.34171 12.0488 8.14645 11.8536C7.95118 11.6583 7.95118 11.3417 8.14645 11.1464L11.2929 8H2.5C2.22386 8 2 7.77614 2 7.5C2 7.22386 2.22386 7 2.5 7H11.2929L8.14645 3.85355C7.95118 3.65829 7.95118 3.34171 8.14645 3.14645Z"
            fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path>
        </svg>
      </button>

      <button id="close-button"
        class="close-button inline-block px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-50 focus:relative">
        Close
      </button>
    </span>

  </div>

  <!-- JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const jumpButton = document.getElementById('jump-button');
      const shareButton = document.getElementById('share-button');
      const closeButtons = document.querySelectorAll('.close-button');
      const jumpResult = document.getElementById('jump-result');
      const jumpIframe = document.getElementById('jump-iframe');
      const infoButton = document.getElementById('info-button');
      const searchBar = document.getElementById('search-bar');
      const infoSection = document.getElementById('info-section');

      // Jump functionality
      jumpButton.addEventListener('click', function () {
        fetch('/jump')
          .then(response => response.json())
          .then(data => {
            if (data.url) {
              if (data.can_embed) {
                jumpIframe.src = data.url;
                jumpResult.style.display = 'block';
              } else {
                window.open(data.url, '_blank');
              }
            }
          })
          .catch(error => {
            console.error('Error:', error);
          });
      });

      // Share functionality
      shareButton.addEventListener('click', function () {
        const url = jumpIframe.src;
        if (!url || url === 'about:blank') {
          alert('No content to share.');
          return;
        }
        if (navigator.share) {
          navigator.share({
            title: 'Check this out!',
            url: url
          }).then(() => {
            console.log('Thanks for sharing!');
          }).catch(console.error);
        } else {
          // Fallback for browsers that do not support the Web Share API
          alert('Your browser does not support the Web Share API');
        }
      });

      // Close functionality for both close buttons
      closeButtons.forEach(function (button) {
        button.addEventListener('click', function () {
          jumpResult.style.display = 'none';
          jumpIframe.src = 'about:blank';
        });
      });

      // Info button functionality
      infoButton.addEventListener('click', function () {
        infoSection.style.display = 'block';
      });

      // Close info section
      document.getElementById('close-info-button').addEventListener('click', function () {
        infoSection.style.display = 'none';
      });

      // Search functionality
      searchBar.addEventListener('keydown', function (event) {
        if (event.key === 'Enter') {
          event.preventDefault();
          const query = searchBar.value.trim();
          if (!query) return;

          fetch('/search?query=' + encodeURIComponent(query))
            .then(response => response.json())
            .then(data => {
              if (data.error) {
                console.error('Search error:', data.error);
                return;
              }
              if (data.url) {
                jumpIframe.src = data.url;
                jumpResult.style.display = 'block';
              }
            })
            .catch(error => {
              console.error('Error:', error);
            });
        }
      });

      // Add pressed state handling for jump button
      jumpButton.addEventListener('mousedown', function () {
        this.classList.remove('hover:scale-105');
        this.classList.add('scale-95');
        this.style.boxShadow = 'inset 0 0 20px rgba(255, 255, 255, 0.5)';
      });

      jumpButton.addEventListener('mouseup', function () {
        this.classList.remove('scale-95');
        this.classList.add('hover:scale-105');
      });
    });
  </script>
</body>

</html>